<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç†ç§‘å…¨èƒ½è§£å¯†ç‹ - çµ‚æ¥µæ•´åˆ</title>
    <style>
        :root { 
            --primary: #2c3e50; --accent: #e67e22; --success: #27ae60; --error: #e74c3c;
            --bg: #f4f7f6; --card: #ffffff;
        }
        body { font-family: 'Segoe UI', 'PingFang TC', sans-serif; background: var(--bg); color: var(--primary); margin: 0; }
        .container { max-width: 1000px; margin: 20px auto; padding: 20px; }
        
        /* æ ¸å¿ƒ Lobbyï¼šè³‡è¨Šç‰†è¨­è¨ˆ */
        .lobby-card { background: var(--card); border-radius: 30px; padding: 40px; box-shadow: 0 20px 50px rgba(0,0,0,0.1); text-align: center; }
        .main-title { font-size: 3rem; font-weight: 900; margin-bottom: 5px; color: var(--primary); }
        .sub-title { color: #7f8c8d; margin-bottom: 30px; letter-spacing: 2px; }

        .tutorial-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 35px; text-align: left; }
        .tuto-box { background: #fffcf5; border: 1px solid #ffeada; padding: 20px; border-radius: 15px; font-size: 0.95rem; line-height: 1.6; position: relative; }
        .tuto-box h4 { margin: 0 0 10px 0; color: var(--accent); font-size: 1.1rem; display: flex; align-items: center; }
        .tuto-box ul { padding-left: 20px; margin: 5px 0; }
        .badge { background: var(--primary); color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; margin-left: 8px; }

        .example-box { background: #fff; border: 1px dashed #e67e22; padding: 12px; border-radius: 10px; margin-top: 10px; font-family: monospace; font-size: 0.85rem; }

        /* éŠæˆ²å ´æ™¯ */
        .scene { display: none; }
        .scene.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .game-layout { display: grid; grid-template-columns: 2fr 1fr; gap: 25px; }
        .equation-box { background: #eff6ff; border: 2px solid #3b82f6; border-radius: 25px; padding: 50px; min-height: 200px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 2rem; color: #1e40af; font-weight: bold; text-align: center; }
        
        input[type="text"] { width: 100%; padding: 18px; font-size: 1.5rem; border: 2px solid #ddd; border-radius: 15px; text-align: center; outline: none; margin: 20px 0; box-sizing: border-box; }
        .btn-main { padding: 18px 60px; font-size: 1.3rem; font-weight: bold; border-radius: 15px; border: none; cursor: pointer; color: white; background: var(--primary); transition: 0.3s; width: 100%; }
        .btn-main:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }

        .sidebar { background: white; border-radius: 20px; padding: 20px; max-height: 600px; overflow-y: auto; border: 1px solid #eee; }
        .letter-tag { display: flex; justify-content: space-between; padding: 6px; border-bottom: 1px solid #f0f0f0; font-family: monospace; font-size: 0.9rem; }
    </style>
</head>
<body>

<div class="container">
    <div id="scene-lobby" class="scene active">
        <div class="lobby-card">
            <h1 class="main-title">ç†ç§‘å…¨èƒ½è§£å¯†ç‹</h1>
            <div class="sub-title">SCIENTIFIC DECODER MAX</div>
            
            <div class="tutorial-grid">
                <div class="tuto-box">
                    <h4>ğŸ“– åŸºç¤è½‰æ›è¦å‰‡</h4>
                    <ul>
                        <li>è§£é¡Œæ±‚å‡ºå…©å€‹æ•¸å­— (ä»£æ•¸ç¬¦è™Ÿåƒ…ç‚ºç¨±å‘¼)ã€‚</li>
                        <li><b>A=1, B=2, ... Z=26</b> (ä¾å­—æ¯åºæ›ç®—)ã€‚</li>
                        <li>æ‹¼æ¹Šï¼šæ•¸å­— P + æ•¸å­— Q â†’ å­—æ¯ P(å¤§å¯«) + å­—æ¯ Q(å°å¯«)ã€‚</li>
                        <li><b style="color:var(--error)">é‡æ ¹ï¼š</b> è‹¥å…©æ•¸ç›¸åŒï¼Œåªå–ä¸€å€‹å¤§å¯«å­—æ¯ã€‚</li>
                    </ul>
                    <div class="example-box">ä¾‹ï¼šè§£å‡º 11, 1 â†’ Ka â†’ ç­”ã€Œé‰€ã€<br>ä¾‹ï¼šè§£å‡º 8, 8 â†’ O â†’ ç­”ã€Œæ°§ã€</div>
                </div>

                <div class="tuto-box">
                    <h4>ğŸ”¥ ç¡¬æ ¸ä»£æ•¸è¦ç¯„ <span class="badge">Lv.2+</span></h4>
                    <ul>
                        <li><b>éš±è—ä¿‚æ•¸ï¼š</b> ä¿‚æ•¸ç‚º 1 æ™‚æœƒçœç•¥ä¸å¯«ã€‚</li>
                        <li><b>åå­—äº¤ä¹˜ï¼š</b> xÂ² é …å¯èƒ½å«ä¿‚æ•¸ï¼Œè«‹æ‹†è§£é¦–å°¾é …ã€‚</li>
                        <li><b>å…¬å¼è§£èˆ‡åˆ¤åˆ¥å¼ï¼š</b> è‹¥æ‹†è§£å¤±æ•—ï¼Œè«‹ç®— D = bÂ² - 4acã€‚</li>
                        <li><b>ç„¡è§£æ©Ÿåˆ¶ï¼š</b> è‹¥åˆ¤åˆ¥å¼ç‚ºè² ï¼Œè«‹ç›´æ¥è¼¸å…¥ã€Œ<b>ç„¡è§£</b>ã€ã€‚</li>
                    </ul>
                    <div class="example-box">3xÂ² - 31x + 70 = 0 â†’ (3x-10)(x-7) â†’ 10, 7</div>
                </div>
            </div>

            <button class="btn-main" onclick="enterGame()">é–‹å§‹è§£å¯†æŒ‘æˆ°</button>
            <p style="margin-top:20px; font-size:0.9rem; color:#95a5a6;">ğŸ† æœ€é«˜ç´€éŒ„ï¼š<span id="best-score">0</span></p>
        </div>
    </div>

    <div id="scene-game" class="scene">
        <div class="game-layout">
            <div class="main-area">
                <div style="margin-bottom:15px; display:flex; justify-content:space-between; align-items:center;">
                    <span id="lvl-display" style="font-weight:bold; color:var(--accent);">LEVEL 1</span>
                    <span style="font-weight:bold;">SCORE: <span id="score">0</span></span>
                </div>
                <div class="equation-box" id="q-text"></div>
                <input type="text" id="ans-input" placeholder="å…ƒç´ åç¨± æˆ– ç„¡è§£" autocomplete="off" onkeypress="if(event.key==='Enter')checkAnswer()">
                <button class="btn-main" onclick="checkAnswer()">æäº¤ (Enter)</button>
                <div id="feedback" style="margin-top:20px; text-align:center; font-weight:bold; min-height:30px;"></div>
                <div style="text-align:center; margin-top:20px;">
                    <button style="background:none; border:none; color:#7f8c8d; text-decoration:underline; cursor:pointer;" onclick="location.reload()">æ”¾æ£„ä¸¦å›ä¸»é </button>
                </div>
            </div>

            <div class="sidebar">
                <p style="text-align:center; font-weight:bold; border-bottom:2px solid #f0f0f0; padding-bottom:10px;">å­—æ¯/å¹³æ–¹ åƒè€ƒè¡¨</p>
                <div id="alphabet-list"></div>
            </div>
        </div>
    </div>
</div>

<script>
    const elementData = {
    "H":"æ°«","He":"æ°¦","Li":"é‹°","Be":"éˆ¹","B":"ç¡¼","C":"ç¢³","N":"æ°®","O":"æ°§","F":"æ°Ÿ","Ne":"æ°–",
    "Na":"éˆ‰","Mg":"é‚","Al":"é‹","Si":"çŸ½","P":"ç£·","S":"ç¡«","Cl":"æ°¯","Ar":"æ°¬","K":"é‰€","Ca":"éˆ£",
    "Sc":"éˆ§","Ti":"éˆ¦","V":"é‡©","Cr":"é‰»","Mn":"éŒ³","Fe":"éµ","Co":"éˆ·","Ni":"é³","Cu":"éŠ…","Zn":"é‹…",
    "Ga":"éµ","Ge":"éº","As":"ç ·","Se":"ç¡’","Br":"æº´","Kr":"æ°ª","Rb":"éŠ£","Sr":"é¶","Y":"é‡”","Zr":"é‹¯",
    "In":"éŠ¦","Sn":"éŒ«","Sb":"éŠ»","Te":"ç¢²","I":"ç¢˜","Xe":"æ°™","Cs":"é««","Ba":"é‹‡","La":"é‘­",
    "Pt":"é‰‘","Au":"é‡‘","Hg":"æ±","Pb":"é‰›","Bi":"é‰","Ra":"é³","Ac":"éŒ’"
};
    let score = 0, level = 1, currentP, currentQ, isNoSol = false, isProc = false;
    let highScore = localStorage.getItem('sciUltraS') || 0;

    document.getElementById('best-score').innerText = highScore;
    const list = document.getElementById('alphabet-list');
    for(let i=1; i<=26; i++) {
        list.innerHTML += `<div class="letter-tag"><span>${String.fromCharCode(64+i)}: ${i}</span><span>Â²=${i*i}</span></div>`;
    }

    function enterGame() {
        document.getElementById('scene-lobby').classList.remove('active');
        document.getElementById('scene-game').classList.add('active');
        nextQuestion();
    }

    function generateQuestion() {
        const vars = ["x", "a", "m", "n"][Math.floor(Math.random()*4)];
        isNoSol = Math.random() < 0.2; // 20% ç„¡è§£æ©Ÿç‡
        const txt = document.getElementById('q-text');
        
        const fmt = (n) => (n === 1 ? "" : n);

        if (isNoSol) {
            const a = Math.floor(Math.random() * 3) + 2;
            const b = Math.floor(Math.random() * 5) + 1;
            const c = Math.floor(Math.random() * 15) + 20;
            txt.innerHTML = `${a}${vars}Â² + ${b}${vars} + ${c} = 0`;
        } else {
            const keys = Object.keys(elementData);
            const sym = keys[Math.floor(Math.random() * keys.length)];
            currentP = sym.charCodeAt(0) - 64;
            currentQ = sym.length > 1 ? sym.charCodeAt(1) - 96 : currentP;

            if (level === 1) {
                // ç­‰ç´š 1: äºŒå…ƒä¸€æ¬¡ (ä¿‚æ•¸ç‚º 1)
                txt.innerHTML = `${vars} + y = ${currentP+currentQ}<br>${vars} - y = ${Math.abs(currentP-currentQ)}`;
            } else {
                // ç­‰ç´š 2+: åå­—äº¤ä¹˜ (axÂ² - (p+aq)x + pq = 0)
                const a = Math.floor(Math.random() * 3) + 2;
                const bVal = currentP + (a * currentQ);
                const cVal = currentP * currentQ;
                txt.innerHTML = `${a}${vars}Â² - ${bVal}${vars} + ${cVal} = 0`;
            }
        }
    }

    function checkAnswer() {
        if(isProc) return;
        const input = document.getElementById('ans-input').value.trim();
        const feedback = document.getElementById('feedback');
        let correct = false;

        if (isNoSol) {
            if (input === "ç„¡è§£") correct = true;
        } else {
            const s1 = String.fromCharCode(64+currentP) + (currentP===currentQ ? "" : String.fromCharCode(96+currentQ));
            const s2 = String.fromCharCode(64+currentQ) + (currentP===currentQ ? "" : String.fromCharCode(96+currentP));
            if (input === elementData[s1] || input === elementData[s2]) correct = true;
        }

        if (correct) {
            isProc = true; score += 10;
            if(score > highScore) { highScore = score; localStorage.setItem('sciUltraS', score); }
            feedback.innerText = "âœ¨ è§£å¯†æˆåŠŸï¼"; feedback.style.color = "var(--success)";
            if (score % 30 === 0) level++; 
            setTimeout(() => { isProc = false; nextQuestion(); }, 1000);
        } else {
            feedback.innerText = "âŒ é‚è¼¯éŒ¯èª¤ï¼Œå†è©¦ä¸€æ¬¡ï¼"; feedback.style.color = "var(--error)";
        }
    }

    function nextQuestion() {
        document.getElementById('ans-input').value = "";
        document.getElementById('ans-input').focus();
        document.getElementById('feedback').innerText = "";
        document.getElementById('score').innerText = score;
        document.getElementById('lvl-display').innerText = "LEVEL " + level;
        generateQuestion();
    }
</script>
</body>
</html>